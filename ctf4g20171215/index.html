<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 第8回 CTF for GIRLS 演習問題 Writeup · alotofwe</title><meta name="description" content="第8回 CTF for GIRLS 演習問題 Writeup - alotofwe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://suzupy.github.com/atom.xml" title="alotofwe"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpeg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/alotofwe" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://twitter.com/alotofwe" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">第8回 CTF for GIRLS 演習問題 Writeup</h1><div class="post-info">Dec 18, 2017</div><div class="post-content"><h1 id="環境"><a href="#環境" class="headerlink" title="環境"></a>環境</h1><p><a href="env.png"><img src="env.png" alt="alt" title="env.png" width="700"></a></p>
<h1 id="初級問題1"><a href="#初級問題1" class="headerlink" title="初級問題1"></a>初級問題1</h1><h2 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h2><p>Disk Image <code>Alice.001</code> に含まれる削除済みファイルからflagを得る<br>ヒント: 削除されたファイルは My Documents/Letters/FromBob に保存されていた</p>
<h2 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h2><p>AccessData FTK ImagerでAlice.001を開き My Documents/Letters/FromBob を見るとSecret.bmpが見つかる<br>適当なバイナリエディタでSecret.bmpを開くとflagが得られる</p>
<p><a href="1.png"><img src="1.png" alt="alt" title="1.png" width="700"></a></p>
<h1 id="初級問題2"><a href="#初級問題2" class="headerlink" title="初級問題2"></a>初級問題2</h1><h2 id="問題-1"><a href="#問題-1" class="headerlink" title="問題"></a>問題</h2><p>Downloads.rarの中からflagを得る</p>
<h2 id="解答-1"><a href="#解答-1" class="headerlink" title="解答"></a>解答</h2><p>Downloads.rarを解凍し、解凍先ディレクトリの代替データストリーム (ADS) を表示する<br>swt0006-024.jpg:Flag.txt:$DATAからflagが得られる</p>
<h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>ADSとはWindowsのファイルシステムNTFSで使われる、ファイルに紐付くメタデータのこと</p>
<p><a href="2.png"><img src="2.png" alt="alt" title="2.png" width="700"></a></p>
<h1 id="初級問題3"><a href="#初級問題3" class="headerlink" title="初級問題3"></a>初級問題3</h1><h2 id="問題-2"><a href="#問題-2" class="headerlink" title="問題"></a>問題</h2><p>.doc形式のファイルからflagを得る</p>
<h2 id="解答-2"><a href="#解答-2" class="headerlink" title="解答"></a>解答</h2><p>拡張子を.zipに変更しファイルを解凍する<br>解凍先ディレクトリ内のflag.txtからflagが得られる</p>
<h1 id="中級問題1"><a href="#中級問題1" class="headerlink" title="中級問題1"></a>中級問題1</h1><h2 id="問題-3"><a href="#問題-3" class="headerlink" title="問題"></a>問題</h2><p>ctf4g.pngの中からflagを得る</p>
<h2 id="解答-3"><a href="#解答-3" class="headerlink" title="解答"></a>解答</h2><p>ctf4g.pngをバイナリエディタで開くと文字列 <code>hoge/flag.bmp</code> <code>hoge/flag.bmpPK</code> が確認できる<br>PKはzipのマジックナンバーなのでpngの中にzipが埋め込まれていると当たりをつけ、<code>hoge/flag.bmp</code> の少し前にある <code>PK</code> より前のデータをすべて削除し解凍する</p>
<p><a href="3.png"><img src="3.png" alt="alt" title="3.png" width="700"></a><br><a href="4.png"><img src="4.png" alt="alt" title="4.png" width="700"></a></p>
<h1 id="中級問題2"><a href="#中級問題2" class="headerlink" title="中級問題2"></a>中級問題2</h1><h2 id="問題-4"><a href="#問題-4" class="headerlink" title="問題"></a>問題</h2><p>ファイル <code>My_Message_is_a_Flag</code> とテキスト <code>外出するので伝言を残しておきますね。</code> が渡される</p>
<h2 id="解答-4"><a href="#解答-4" class="headerlink" title="解答"></a>解答</h2><p><code>My_Message_is_a_Flag</code> のマジックナンバーからレジストリファイルであることが分かる<br>AccessData Registory Viewerで開き、伝言に関連がありそうな怪しいディレクトリを見るとflagが得られる</p>
<p><a href="5.png"><img src="5.png" alt="alt" title="5.png" width="700"></a><br><a href="6.png"><img src="6.png" alt="alt" title="6.png" width="700"></a></p>
<p>(自分はレジストリの知識が無いので怪しそうなディレクトリが分からず探すのが大変だった)</p>
<h1 id="上級問題1"><a href="#上級問題1" class="headerlink" title="上級問題1"></a>上級問題1</h1><h2 id="問題-5"><a href="#問題-5" class="headerlink" title="問題"></a>問題</h2><p>ファイル <code>Forensics_advanced.E01</code> とテキスト <code>仲間はずれはどれ？</code> が渡される</p>
<h2 id="解答-5"><a href="#解答-5" class="headerlink" title="解答"></a>解答</h2><p>fileコマンドでimage fileであることを確認<br>AccessData FTK Imagerで開くとディレクトリ <code>[root]/flag/flag.zip</code> があり、Exportして解凍しようとするとパスワードを要求される</p>
<p>image fileの <code>[root]/pass</code> にFlagXXX.txtが300個あり、この中にパスワードが書かれていると当たりをつける<br>与えられたテキストをヒントに仲間はずれを探すと、Sizeが唯一0, Date Modifiedが他のファイルと異なっているFlag263.txtが見つかる<br>Flag263.txtの内容は削除されているが、ファイルシステムがNTFSで削除したファイルのサイズが小さいので <code>[root]/$MFT</code> に内容が残っており、そこにパスワードが書かれている</p>
<p>このパスワードでflag.zipを解凍すると画像としてflagが書かれたFlag.jpgが得られる</p>
<h2 id="補足-1"><a href="#補足-1" class="headerlink" title="補足"></a>補足</h2><p>$MFTはNTFSで使われるマスターファイルテーブルで、全てのファイルのエントリを管理している<br>エントリはレコードタイプ, レコード番号, Active/Inactiveフラグ, $DATA属性などを含む<br>約680byte以下のファイルの場合は$DATA属性にファイル内容が記録される</p>
<p><a href="7.png"><img src="7.png" alt="alt" title="7.png" width="700"></a><br><a href="8.png"><img src="8.png" alt="alt" title="8.png" width="800"></a><br><a href="9.png"><img src="9.png" alt="alt" title="9.png" width="900"></a></p>
<h1 id="上級問題2"><a href="#上級問題2" class="headerlink" title="上級問題2"></a>上級問題2</h1><h2 id="問題-6"><a href="#問題-6" class="headerlink" title="問題"></a>問題</h2><p>ファイル <code>Forensics300.E01</code> とテキスト <code>兵器密売に関する情報を入手した！このファイルを解析し、兵器密売の場所となる情報を取り出せ！</code> が渡される</p>
<h2 id="解答-6"><a href="#解答-6" class="headerlink" title="解答"></a>解答</h2><p>AccessData FTK Imagerで開くとディレクトリ <code>[root]/The site.zip</code> があり、Exportして解凍しようとするとパスワードを要求される<br>削除済みファイル <code>[root]/secret_pass.txt</code> があり、これはunallocated spaceに残っているので復元可能  </p>
<p>入手したパスワードでThe site.zipを解凍するとSite.docxが得られ、これをSite.zipにリネームして解凍<br>word/media/image1.jpegのExif情報からflagが得られる</p>
<h2 id="補足-2"><a href="#補足-2" class="headerlink" title="補足"></a>補足</h2><p>unallocated spaceでは削除されInactiveフラグが立っているファイルが確認できる</p>
<p><a href="10.png"><img src="10.png" alt="alt" title="10.png" width="1000"></a></p>
</div></article></div></main><footer><div class="paginator"><a href="/acm-icpc-2017-asia-tsukuba-regional/" class="prev">PREV</a><a href="/hardening2017fes/" class="next">NEXT</a></div><div class="copyright"><p>If you find some wrong in my articles, please notify me at Twitter.</p><p>© 2015 - 2017 <a href="http://suzupy.github.com">alotofwe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>