<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> SECCON 2017 Writeup · alotofwe</title><meta name="description" content="SECCON 2017 Writeup - alotofwe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://suzupy.github.com/atom.xml" title="alotofwe"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpeg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/alotofwe" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://twitter.com/alotofwe" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">SECCON 2017 Writeup</h1><div class="post-info">Dec 12, 2017</div><div class="post-content"><p>My team solved <code>Vigenere3d</code>, <code>Run me!</code>, <code>putchar music</code>, <code>SHA-1 is dead</code> and <code>Thank you for playing!</code> and got 500 points.</p>
<h1 id="putchar-music"><a href="#putchar-music" class="headerlink" title="putchar music"></a>putchar music</h1><p>I searched <code>putchar music</code> then I’ve found <a href="https://www.youtube.com/watch?v=L9KLnN0GczI" target="_blank" rel="noopener">Creating music in one line of C code</a>.<br>/dev/dsp is one of driver used in OSS (Open Sound System) but it is old slightly.<br>Instead of it, we can use ALSA installed in Ubuntu 17.10 by default.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cat a.c</span><br><span class="line"><span class="function"><span class="title">main</span></span>()&#123;int t,i,j; unsigned char p[]=<span class="string">"###&lt;f_YM\204g_YM\204g_Y_H #&lt;f_YM\204g_YM\204g_Y_H #+-?[WKAMYJ/7 #+-?[WKgH #+-?[WKAMYJ/7hk\206\203tk\\YJAfkkk"</span>;<span class="keyword">for</span>(i=0;t=1;i=(i+1)%(sizeof(p)-1))&#123;double x=pow(1.05946309435931,p[i]/6+13);<span class="keyword">for</span>(j=1+p[i]%6;t++%(8192/j);)putchar(t&gt;&gt;5|(int)(t*x));&#125;&#125;</span><br><span class="line">$ gcc a.c -lm &gt; /dev/null 2&gt;&amp;1; ./a.out | aplay</span><br></pre></td></tr></table></figure>
<h1 id="Ps-and-Qs"><a href="#Ps-and-Qs" class="headerlink" title="Ps and Qs"></a>Ps and Qs</h1><p>ref: <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Key_generation" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Key_generation</a></p>
<p>In this problem, pub1 and pub2 are using the same prime number.<br>Therefore we can calcurate <em>p</em> and <em>q</em> by <code>p = gcd(pub1, pub2)</code> <code>q = pub1 / p</code> and create the private key by following steps:</p>
<blockquote>
<ol>
<li>Choose two distinct prime numbers p and q.</li>
<li>Compute n = pq.</li>
<li>Compute λ(n) = lcm(λ(p), λ(q)) = lcm(p − 1, q − 1), where λ is Carmichael’s totient function. This value is kept private.</li>
<li>Choose an integer e such that 1 &lt; e &lt; λ(n) and gcd(e, λ(n)) = 1; i.e., e and λ(n) are coprime.</li>
<li>Determine d as d ≡ e−1 (mod λ(n)); i.e., d is the modular multiplicative inverse of e (modulo λ(n)).</li>
</ol>
</blockquote>
<p><em>p</em>, <em>q</em> and <em>e</em> are already given.<br><em>d</em> satisfy a formula <code>e * d (mod λ(n)) = 1</code> so we can calculate it by using <a href="https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm" target="_blank" rel="noopener">Extended Euclidean algorithm</a>.</p>
<blockquote>
<p>Decryption</p>
<p>Alice can recover m from c by using her private key exponent d by computing<br>c^d ≡ (m^e)^d ≡ m (mod n)<br>Given m, she can recover the original message M by reversing the padding scheme.</p>
</blockquote>
<p>Now <em>c</em> and <em>d</em> is known, so we can decrypt the cipher.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ openssl rsa -text -modulus -pubin &lt; pub1.pub 2&gt;&amp;1 | grep Exponent | awk <span class="string">'&#123;print $2&#125;'</span></span><br><span class="line">65537</span><br><span class="line">$ openssl rsa -text -modulus -pubin &lt; pub1.pub 2&gt;&amp;1 | grep Modulus= | awk -F= <span class="string">'&#123;print "0x"$2&#125;'</span></span><br><span class="line">0xCFCFBBEEA7DF143A8AC208B1AA1D2F86545AC4CB588C94A3FB1C14AD91A4F0B936157C5A4B869C18A8B864F4726BF8FCDC020CB41042BAC96784AB7D03F9374947EFB0BC3D665831974340159FFC3DB7C8E74B6390FDA6EEC30B81C6FF624E8D3F5B17BFB7A5C7FFD8ECF4E6518B393ABEFDDD0FAEBA4308746BA63F8106B59D7E058943A00131A7D4E538C464B270577647EDBC478CC1CE9585EFE877305B3A7C2E7C44DB5475EDDADC345A2C90A946771CAC0A454CDBCB461F2840E7613C83E9CECC94037FA09BB9DAA3F180562C01DF0BE6C51F0C06E8F0E2D6E1A5E50D0A28C3881140770A9F45934146B7F359B939CE23F0FA507A6F4E454571430952003C20F1D97A67140B6E5FCBFB3B376E4E24969AEB1D489CFC72AF4F15A4788A1AA97C89756D1D4D94AA47E7CD3A81AECB92448CC92C77D2EF576AA0DBC1350862ACCDDADDBCE80357F0CD5B854DD0F8C4627FE4B718B24ECFE11ED24C3BE22F00643BBED4EE5E345AF176E5B76D23A2F80E0EC6F34E5718C62A70FE5570C28B807B44F22EADEBD9B5FF906F6A85BE88C0C8F6E5F880A51F17F84DB1C2EEFEA8AF34040444CED1A37DF0E4F5F72CC3F50B7E427C8C2D8B6186EAD762F0C444B3CA3A0103ED12A93BCE9CAE7479A229EBBC0A648EAA6F97E5051A66EB09EBD7348E92F75F125EBDC367E2A7D1DA7759D41FAE2E2635BF4B7A7F91BECAB3AC7D05BD</span><br><span class="line">$ openssl rsa -text -modulus -pubin &lt; pub2.pub 2&gt;&amp;1 | grep Modulus= | awk -F= <span class="string">'&#123;print "0x"$2&#125;'</span></span><br><span class="line">0xBB33CC7FCC8ECAF3BF9ED95C583792E1EC6B80EE875EC2064DBCF07595C8344923BF536524D4E0A75574C7798C73B197DD2B1B42054B1E49CB45FBF04E6F114CF8A365C3DF3645524F778268038A3FA26802E9D1EDBFBB5EDFB5A0C375370D7F10F57DABBD4F771DAD3632F01B9BCE10489966EE882DAB17A33B786AA5F73165A54051300B1DF9280392A3EDE9D3FC9C4D8A6A06351F6EF3598E8DE2B39D3B19AF64A1716CD15826C3F24CB13DEB722C3A03EF1D2BE2D0A5A6E210FF5D018367BE3BF99EA26BA006E5164A4DD55AABCD449DE5CE1864825DC160E50D509EB0E6FE723EF182681EDDB94084B83EC9E2E943E87CB87509AB0FD9B1CA22C1CEAFF39FCACF6729FC0E0578670D87D7F0F9CCBE09CB3E12CEB895572A9979D10BFDBFAFA260568D8DB184BE12B3E3193E07729CE3C1D9CD8283ED6983A06388036A0A70294F23392944778280E7DE9F60163A8150E30FF4A4EA02792CBE8305BAA2E99AFE51E17DAFC56BE0D384147BCD38E9D12934EC712622217773A4B3851A9B0C6C7C3E01F6111A1E1A557F4E2AE4A247CE9B75CCCCB1819825F3054AA1C055BD3E2340093AE2EF1D0FA5A176825EFDF79507027F5104080009142F0D43E2F10CFAD220813BBB9014D4F4325EDAC538FB5E82B753E2AD3B24607D7380AA64FCB98B59EA8B5A736B809383248CECE0B17255EA559E90127F778AF6D7E8A66DAD91</span><br><span class="line">$ od -An -tx1 cipher | tr <span class="string">"\n"</span> <span class="string">" "</span> | sed <span class="string">'s/ //g'</span> | awk <span class="string">'&#123;print "0x"$1&#125;'</span></span><br><span class="line">0xa14ddfb8cb18cf8b22e898e7ce6a2050b2f732e462b987cd5924605eac67c6d2ce2e95ea688299aec2d3b4b9544d6c30ab6d1f55c8e498b9be30dbb4a8bdd7300aa51cd00812db242c8b58952338f1e37439c74dc063f85c4997c5a7dd99ff4cba4322ba7bcf8c967a5c4d8560dda2607454605339a28cdc0c046e51ac828e6913588509be1e9492af42e01cac6a0301244dcadaebfbe8408120d7136cf3440348095b8996c3a3306c4bb6f0959c821137c64e1d6eb6bbabf60529166b777e6fc02afe0194683622f3420077097d7987786d06f601f9231677340e288828ee9a56e6e57a5f9435468a252765289e56b8ae9eec7189aca04f556eac0af3c30f862440f61bda0fbbd92975c8f83b78b6ad586dc3697955ff92b222b585017f8b58119707c65e222cde343da8f4f058b78d2554fd624a22df567c51fcac5f51498828c775a2a67a5ec0a6e10a3f329d2b3e42cf1666268b174eab14501d89ffaa6943c059f81b00cc29f827ef489f99ccc94cd3b5780924f25c76c85e867df5134d2ea1e45f9c1a6c74b143eb0c051254aede5d0f4e2deca6461f482703b75f0df85542ee25783ffd6ee1dd508c1b7679e17bd2030040a82e7873bb4c5cc83db817f7d7cb776c178f8750f8b5f3c00839cf005e0aadbe6ecfc14c6d603f3feb6c1eaf98b9c902b098867b5505bc14ab3b359f7f6218e6713ae9ed5a1025b8adc415</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><figcaption><span>ps_and_qs.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> crypto_commons.rsa.rsa_commons <span class="keyword">import</span> gcd, modinv</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">pub1 = <span class="number">0xCFCFBBEEA7DF143A8AC208B1AA1D2F86545AC4CB588C94A3FB1C14AD91A4F0B936157C5A4B869C18A8B864F4726BF8FCDC020CB41042BAC96784AB7D03F9374947EFB0BC3D665831974340159FFC3DB7C8E74B6390FDA6EEC30B81C6FF624E8D3F5B17BFB7A5C7FFD8ECF4E6518B393ABEFDDD0FAEBA4308746BA63F8106B59D7E058943A00131A7D4E538C464B270577647EDBC478CC1CE9585EFE877305B3A7C2E7C44DB5475EDDADC345A2C90A946771CAC0A454CDBCB461F2840E7613C83E9CECC94037FA09BB9DAA3F180562C01DF0BE6C51F0C06E8F0E2D6E1A5E50D0A28C3881140770A9F45934146B7F359B939CE23F0FA507A6F4E454571430952003C20F1D97A67140B6E5FCBFB3B376E4E24969AEB1D489CFC72AF4F15A4788A1AA97C89756D1D4D94AA47E7CD3A81AECB92448CC92C77D2EF576AA0DBC1350862ACCDDADDBCE80357F0CD5B854DD0F8C4627FE4B718B24ECFE11ED24C3BE22F00643BBED4EE5E345AF176E5B76D23A2F80E0EC6F34E5718C62A70FE5570C28B807B44F22EADEBD9B5FF906F6A85BE88C0C8F6E5F880A51F17F84DB1C2EEFEA8AF34040444CED1A37DF0E4F5F72CC3F50B7E427C8C2D8B6186EAD762F0C444B3CA3A0103ED12A93BCE9CAE7479A229EBBC0A648EAA6F97E5051A66EB09EBD7348E92F75F125EBDC367E2A7D1DA7759D41FAE2E2635BF4B7A7F91BECAB3AC7D05BD</span></span><br><span class="line">pub2 = <span class="number">0xBB33CC7FCC8ECAF3BF9ED95C583792E1EC6B80EE875EC2064DBCF07595C8344923BF536524D4E0A75574C7798C73B197DD2B1B42054B1E49CB45FBF04E6F114CF8A365C3DF3645524F778268038A3FA26802E9D1EDBFBB5EDFB5A0C375370D7F10F57DABBD4F771DAD3632F01B9BCE10489966EE882DAB17A33B786AA5F73165A54051300B1DF9280392A3EDE9D3FC9C4D8A6A06351F6EF3598E8DE2B39D3B19AF64A1716CD15826C3F24CB13DEB722C3A03EF1D2BE2D0A5A6E210FF5D018367BE3BF99EA26BA006E5164A4DD55AABCD449DE5CE1864825DC160E50D509EB0E6FE723EF182681EDDB94084B83EC9E2E943E87CB87509AB0FD9B1CA22C1CEAFF39FCACF6729FC0E0578670D87D7F0F9CCBE09CB3E12CEB895572A9979D10BFDBFAFA260568D8DB184BE12B3E3193E07729CE3C1D9CD8283ED6983A06388036A0A70294F23392944778280E7DE9F60163A8150E30FF4A4EA02792CBE8305BAA2E99AFE51E17DAFC56BE0D384147BCD38E9D12934EC712622217773A4B3851A9B0C6C7C3E01F6111A1E1A557F4E2AE4A247CE9B75CCCCB1819825F3054AA1C055BD3E2340093AE2EF1D0FA5A176825EFDF79507027F5104080009142F0D43E2F10CFAD220813BBB9014D4F4325EDAC538FB5E82B753E2AD3B24607D7380AA64FCB98B59EA8B5A736B809383248CECE0B17255EA559E90127F778AF6D7E8A66DAD91</span></span><br><span class="line">cipher = <span class="number">0xa14ddfb8cb18cf8b22e898e7ce6a2050b2f732e462b987cd5924605eac67c6d2ce2e95ea688299aec2d3b4b9544d6c30ab6d1f55c8e498b9be30dbb4a8bdd7300aa51cd00812db242c8b58952338f1e37439c74dc063f85c4997c5a7dd99ff4cba4322ba7bcf8c967a5c4d8560dda2607454605339a28cdc0c046e51ac828e6913588509be1e9492af42e01cac6a0301244dcadaebfbe8408120d7136cf3440348095b8996c3a3306c4bb6f0959c821137c64e1d6eb6bbabf60529166b777e6fc02afe0194683622f3420077097d7987786d06f601f9231677340e288828ee9a56e6e57a5f9435468a252765289e56b8ae9eec7189aca04f556eac0af3c30f862440f61bda0fbbd92975c8f83b78b6ad586dc3697955ff92b222b585017f8b58119707c65e222cde343da8f4f058b78d2554fd624a22df567c51fcac5f51498828c775a2a67a5ec0a6e10a3f329d2b3e42cf1666268b174eab14501d89ffaa6943c059f81b00cc29f827ef489f99ccc94cd3b5780924f25c76c85e867df5134d2ea1e45f9c1a6c74b143eb0c051254aede5d0f4e2deca6461f482703b75f0df85542ee25783ffd6ee1dd508c1b7679e17bd2030040a82e7873bb4c5cc83db817f7d7cb776c178f8750f8b5f3c00839cf005e0aadbe6ecfc14c6d603f3feb6c1eaf98b9c902b098867b5505bc14ab3b359f7f6218e6713ae9ed5a1025b8adc415</span></span><br><span class="line"></span><br><span class="line">p = gcd(pub1, pub2)</span><br><span class="line">q = pub1 / p</span><br><span class="line">d = modinv(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">b = pow(cipher, d, pub1)</span><br><span class="line"><span class="keyword">print</span> long_to_bytes(b)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ python ps_and_qs.py</span><br><span class="line">�H4؋ѝ2l�r</span><br><span class="line">�puF`u�܎��3�4CT�R</span><br><span class="line">  ��V�.dZ[]���%��)() _�d�</span><br><span class="line">                         |�o�h�o�V��s&#123;t_�vӫ�1ۧ�[:�X�Y��%�%��r�9dJ�|�������7��M��</span><br><span class="line">                                                                               g�B����݁t^Scq�`H�0�c�f��Ŏ\�</span><br><span class="line">                                                                                                         6�a ��<span class="string">"5`�_�et:</span></span><br><span class="line"><span class="string">��a�C	=�L�X�	UmL�b�'���\�X��3��l&gt;��(W!��T����e�DǷ.��?f�L.�U������nR~J�.�'�&amp;/��w����!A�wS"</span>U��Z�*�	���E�T�d�w�@�J!�=��<span class="string">"��,����Dh������	����(�l���4UayXg4Ї4Z�Z��Ma��5���|�ۻ�;Z�-S�@��]&gt;	\n6&gt;�g�MBK��E�@�a�VYԹB�p���`[�5�1�],�GA"</span>.�</span><br><span class="line">                                  ��5�摨SECCON&#123;1234567890ABCDEF&#125;</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>If you find some wrong in my articles, please notify me at Twitter.</p><p>© 2015 - 2017 <a href="http://suzupy.github.com">alotofwe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>